FUNCTION_BLOCK attacks
VAR_INPUT               // ulazne varijable
	access_vector : REAL;
    	access_complexity : REAL;
    	confidentiality_impact : REAL;
	integrity_impact : REAL;
	availability_impact: REAL;
	report_confidence : REAL;
	collateral_damage_potential: REAL;
	attack_complexity: REAL;
	privileges_required: REAL;
END_VAR

VAR_OUTPUT              // izlazne varijable
	risk_of_vulnerability : REAL;
END_VAR

FUZZIFY access_vector
	TERM local := (0, 0) (0.7, 1) (1, 0);
	TERM remote := (0.6, 0) (1, 1) ;
END_FUZZIFY

FUZZIFY access_complexity
	TERM high := (0, 0) (0.8, 1) (1, 0);
	TERM low := (0.7,0) (1, 1);
END_FUZZIFY

FUZZIFY confidentiality_impact
	TERM none := (0, 1) (0.3, 0);
	TERM partial := (0.3, 0) (0.7, 1) (0.8, 0);
	TERM complete := (0.7, 0) (1, 1);
END_FUZZIFY

FUZZIFY integrity_impact
	TERM none := (0, 1) (0.3, 0);
	TERM partial := (0.3, 0) (0.7, 1) (0.8, 0);
	TERM complete := (0.7, 0) (1, 1);
END_FUZZIFY

FUZZIFY availability_impact
	TERM none := (0, 1) (0.3, 0);
	TERM partial := (0.2, 0) (0.7, 1) (0.8, 0);
	TERM complete := (0.7, 0) (1, 1);
END_FUZZIFY

FUZZIFY report_confidence
	TERM unconfirmed := (0.8, 0) (0.9, 1) (0.935, 0);
	TERM uncorroborated := (0.915, 0) (0.95, 1) (0.985, 0);
	TERM confirmed := (0.965, 0) (1, 1);
END_FUZZIFY

FUZZIFY collateral_damage_potential
	TERM none := (0, 1) (0.1, 0);
	TERM low := (0, 0) (0.1, 1) (0.3, 0);
	TERM medium := (0.1, 0) (0.3, 1) (0.5, 0);
	TERM high := (0.3, 0) (0.5, 1) ;
END_FUZZIFY

FUZZIFY attack_complexity
	TERM low := (0.5, 0) (0.77, 1) (0.8, 0);
	TERM high := (0.3, 0) (0.44, 1) (0.6, 0);
END_FUZZIFY

FUZZIFY privileges_required
	TERM none :=  (0.7, 0) (0.85,1) (0.9, 0);
	TERM low := (0.45, 0) (0.62, 1) (0.75, 0);
	TERM high := (0, 0) (0.27, 1) (0.5, 0);
END_FUZZIFY

DEFUZZIFY risk_of_vulnerability
	TERM none := (0, 1) (0.1, 0);
    	TERM low := (0.1, 0) (2, 1) (4, 0);
    	TERM medium := (4, 0) (5.5, 1) (7, 0);
    	TERM high := (7, 0) (8, 1) (9, 0);
    	TERM critical := (9, 0) (10, 1);
	METHOD : COG;		// 'Center Of Gravity' odn. centar mase (koristi se i MM odn. mean max)
	DEFAULT := 0;		// podrazumevana vrednost (ukoliko nijedno pravilo nije aktivirano)	
END_DEFUZZIFY

RULEBLOCK blok1
	AND : MIN;			// za konjunkciju se koristi minimum (samim tim sa za disjunkciju koristi maksimum)
	ACT : MIN;			// za zakljuƒçivanje (implikaciju) je izabran minimum (Mamdani implikacija) (osim MIN koristi se i PROD)
	ACCU : MAX;			// za kompoziciju je izabran maksimum (osim MAX koristi se i SUM)

	RULE 1 : IF access_vector IS local THEN risk_of_vulnerability IS low;
	RULE 2 : IF access_vector IS remote THEN risk_of_vulnerability IS high;
	RULE 3 : IF access_complexity IS high THEN risk_of_vulnerability IS low;
	RULE 4 : IF access_complexity IS low THEN risk_of_vulnerability IS critical;
	RULE 5 : IF confidentiality_impact IS none THEN risk_of_vulnerability IS none;
	RULE 6 : IF confidentiality_impact IS partial THEN risk_of_vulnerability IS high;
	RULE 7 : IF confidentiality_impact IS complete THEN risk_of_vulnerability IS critical;
	RULE 8 : IF integrity_impact IS none THEN risk_of_vulnerability IS none;
	RULE 9 : IF integrity_impact IS partial THEN risk_of_vulnerability IS high;
	RULE 10 : IF integrity_impact IS complete THEN risk_of_vulnerability IS critical;
	RULE 11 : IF availability_impact IS none THEN risk_of_vulnerability IS none;
	RULE 12 : IF availability_impact IS partial THEN risk_of_vulnerability IS high;
	RULE 13 : IF availability_impact IS complete THEN risk_of_vulnerability IS critical;
	RULE 14 : IF report_confidence IS unconfirmed THEN risk_of_vulnerability IS low;
	RULE 15 : IF report_confidence IS uncorroborated THEN risk_of_vulnerability IS medium;
	RULE 16 : IF report_confidence IS confirmed THEN risk_of_vulnerability IS high;
	RULE 17 : IF collateral_damage_potential IS none THEN risk_of_vulnerability IS none;
	RULE 18 : IF collateral_damage_potential IS low THEN risk_of_vulnerability IS medium;
	RULE 19 : IF collateral_damage_potential IS medium THEN risk_of_vulnerability IS high;
	RULE 20 : IF collateral_damage_potential IS high THEN risk_of_vulnerability IS critical;
	RULE 21 : IF attack_complexity IS low THEN risk_of_vulnerability IS critical;
	RULE 22 : IF attack_complexity IS high THEN risk_of_vulnerability IS medium;
	RULE 23 : IF privileges_required IS none THEN risk_of_vulnerability IS critical;
	RULE 24 : IF privileges_required IS low THEN risk_of_vulnerability IS medium;
	RULE 25 : IF privileges_required IS high THEN risk_of_vulnerability IS low;

	
END_RULEBLOCK

END_FUNCTION_BLOCK